<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <canvas id = "canvas" width="500" height="500" style = " border:1px,solid,#333;background:#666;"></canvas>
    <script src="./whistle.js"></script>
    <script>
        var canvas = document.getElementById("canvas");
        var Ws = new Ws(canvas);// 获取画布
        var stage = new Stage(Ws);//
        var rect1 = new stage.Rect({text:"blue",x:400,y:400, fillColor:Util.getRandomColor(),width:60,orderDraw:false})
        stage.add(rect1)

        var rect2 = new stage.Rect({text:"bottom_center",x:40,y:40, orderDraw: false})
        stage.add(rect2)

        var rect3 = new stage.Rect({ text: "11111", x: 100, y: 100,fillColor: Util.getRandomColor("rgba"),isHighLight:false})
        stage.add(rect3)
        rect3.drawImage("./a.png",true);
        //rect3.setAttr([])
        // rect3.on("mousedown",function (params) { // 回传的参数包括，当前的画笔工具和鼠标位置信息
        //     console.log(this)  // 回调函数中的 this 是指向当前的节点的
        // })
        // var x = 3;
        // var y = 1;
        //setInterval(aa,500)

        function aa() {
            var x = Math.random()*4;
            var y = Math.random()*4;
            if( rect1.x < 0 ){
                return ;
            }
            dx = rect1.x - x
            dy = rect1.y - y
            rect1.setAttr( {x:dx,y:dy} )
            if ((Math.abs(rect1.centerPos.x - rect2.centerPos.x)) < 20) {
                rect2.setAttr({ x: 400, y: 400 })
                console.log("boom")
            }
            requestAnimationFrame(aa)
        }

        function bb() {
            var x = Math.random() * 3;
            var y = Math.random();
                if (rect2.x < 0) {
                    return;
                }
                dx = rect2.x - x
                dy = rect2.y - y
                rect2.setAttr({ x: dx, y: dy })
                if ( (Math.abs(rect1.centerPos.x - rect2.centerPos.x)) < 20) {
                    rect2.setAttr({x:400,y:400})
                 }
                requestAnimationFrame(bb)
            }
        rect1.on("click",function () {
            aa()
            bb()
        })
    </script>
</body>
</html>